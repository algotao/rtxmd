---
sidebar_position: 7
toc_max_heading_level: 5
description: 全面解答RTA接入常见问题！本文详细介绍了新客接入RTA的流程、所需材料、各阶段要求，以及正式接入后的服务质量指标查看方式。同时，针对性能、缓存、资源投入、隐私与安全等常见问题给出专业解答，为RTA接入提供全方位指导。
keywords: [RTA接入, 常见问题, 新客接入, 接入流程, 服务质量指标, 性能问题, 缓存问题, 资源投入, 隐私与安全]
---

# 常见问题

## 新客接入

#### 接入流程是怎么样的，需要准备哪些材料？
请参阅文档[准入申请](/docs/rta/rule/apply.md)

#### 正式启用前会经历哪些阶段？
* 客户开发：客户根据交互[协议内容](/rta/dev/proto.md)开发RTA服务。<br />
* 模拟验证：媒体侧人工发起请求，客户需提供少量设备号以便媒体平台验证`接受` `拒绝`等场景的回复是否符合预期。<br />
* 压测评估：媒体侧发起压测请求，QPS在压测中可控制。逐步放到申请QPS最大值且质量指标符合预期则为通过。

#### 正式接入后的服务质量指标在哪里看？
请前往[质量指标监控](https://stat.algo.com.cn/)。使用媒体平台提供的RTAID/Token登录。

## 性能问题类

#### RTA的60ms是从什么时间开始计时，有哪些构成？
从媒体RTA服务发出请求开始计时。其耗时包括`网络RTT`、`客户侧负载均衡等接入层耗时`、`客户侧DSP逻辑处理耗时`、`数据传输耗时`。

#### RTA请求只给了60ms，有些不够用。能否加大交互上限时间？
**不能**。RTA在广告系统中有着复杂的串行/并行依赖关系。受限于媒体给予广告系统的耗时上限，在广告推荐链路中合理分配各阶段的耗时极具挑战。RTA的外发请求与检索召回并行，耗时上限的增加使整个召回粗排阶段的短板效应突出。粗排耗时挤压精排会对广告推荐精度产生负面影响。

#### 跨地域传输耗时参考值(Ping RTT)？
|  字段名称 | 华北(北京/天津) | 华东(上海/杭州) | 华南(广州/深圳) |
|  ----  | ----  | ---- | ---- |
|  华北(北京/天津)  | 1-5ms  | 27-33ms | 37-43ms |
|  华东(上海/杭州)  | 27-33ms  | 1-5ms | 27-33ms |
|  华南(广州/深圳)  | 37-43ms | 27-33ms | 1-5ms |


#### 超时率要求是怎么样的？如果发生超时会如何？
新客户压测`<1%`，常态时期`<2%`。压测期超时将无法转为正式对接状态。日常发版等原因造成的小幅短时间波动引起的超时会忽略。较为严重或持续时间较长时我们会问询原因并做应对。长期严重超时且未整改则按考核规则清退。
超时达到阈值时还会引起系统自动QPS打压。(应答错误也视为超时)

#### 发起请求的来源地区有哪些？能否只从一地发起以减少网络耗时？
深圳、上海、天津。<br />**不能**。媒体RTA服务部署与媒体流量接入点的地域对等，跨地域网络传输时间会被计入RTA处理耗时。

## 缓存问题类

#### 缓存设置了N小时，为何离在不到N小时的时间段内同设备还有多次发送？
* 媒体侧的RTA服务部署在三地，三地间缓存不互通导致。
* 缓存读取时有小比例失败，读失败时会发出请求。
* 平台使用的主缓存设备号与客户侧设备号逻辑有差异。

#### 缓存可选择的上下限是多久？能否设置为无缓存？
最低1小时，最高7天。<br />
**不能**。全量无缓存请求达100W以上，媒体平台难以承受无缓存带来的系统冲击，对客户也是巨大的挑战。<br />
如缓存时间不能满足要求，请考虑对接RTB业务。


## 资源投入类

#### 接入需多少机器资源及带宽资源？
对接全量媒体RTA请求且设定1小时缓存时间，经验值：外发25Wqps（峰值30W），带宽300-500Mbps，逻辑计算90-180核。
#### 带宽和机器成本很高，如何减少发送QPS？
 * 仅下发有广告投放的站点集流量（通知媒体RTA团队操作）
 * 仅下发有广告投放的终端平台(Android/iOS)流量（通知媒体RTA团队操作）
 * 设置实时交互中的自定义缓存时间并拉长（客户自行处理）

#### 如何减少单次请求与回复体积大小以减少带宽使用量？
RTA使用http协议进行实时交互，内容由http header和http body构成。与浏览器的http交互相比，RTA交互协议仅使用了http中极小子集，有大量的http header在交互中不必传输。在极端精简场景中header仅需 `HTTP State` `Content-Length` 即可工作。此举可为客户侧节约50-150字节每请求。
```http title="回复Header示例"
HTTP/1.1 200 OK
Content-Length: 18
```

## 隐私与安全类

#### 能否下发用户性别、年龄、兴趣、安装App等属性标签？
**不能**。请参阅相关法律法规。[《中华人民共和国个人信息保护法》](http://www.npc.gov.cn/npc/c2/c30834/202108/t20210820_313088.html)